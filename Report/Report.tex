% Template for ICASSP-2010 paper; to be used with:
%          mlspconf.sty  - ICASSP/ICIP LaTeX style file adapted for MLSP, and
%          IEEEbib.bst - IEEE bibliography style file.
% --------------------------------------------------------------------------
\documentclass{article}
\usepackage{amsmath,graphicx,02460}



\toappear{02460 Advanced Machine Learning, DTU Compute, Spring 2015}


\def\x{{\mathbf x}}
\def\L{{\cal L}}

\title{Relating EEG microstates to the Default Mode Network}
\name{Magnus Alexander Bitsch (s103243), 
Franciszek Olaf Zdyb (s093086),
Anna Maria Walach (s121540) }
\address{Technical University Of Denmark}

\begin{document}
%\ninept
%

\maketitle
%
\begin{abstract}

\end{abstract}
%
\begin{keywords}
machine learning, EEG, fMRI, microstates, Default Mode Network
\end{keywords}
%
\section{Introduction}
The aim of this project is to find relation between EEG-derived microstates and Default Mode Network (DMN) from fMRI, using methods described in \cite{Yuan20122062}.

Alterations in DMN have been connected to various neurological diseases, like Alzheimerâ€™s or schizophrenia \cite{Yuan20122062}, \cite{Khanna2015105}. DMN can be easily detected by fMRI scanning, but it is an expensive procedure requiring a visit to the hospital. If correlation between EEG and DMN from fMRI can be found, it may allow the use of EEG as a cheaper and more portable tool for diagnosis of neurological diseases.

\subsection{Microstates}
Microstates are unique topographic distributions of the electrical field potential in the brain  \cite{Khanna2015105}. They are transient, patterned and quasi stable (\~100 ms). They are derived from EEG signal using either temporal clustering or temporal ICA. Microstate analysis has been used for assessing the function of large-scale brain networks.

\subsection{Default Mode Network}
Resting State Networks (RSNs) are networks of brain regions, that are active when a person is resting (but not sleeping). Default Mode Network (DMN) is one of the most researched RSNs. It is becoming active when one mind is "wandering". Its subsystems include part of the medial temporal lobe for memory, part of the medial prefrontal cortex for theory of mind, and the posterior cingulate cortex for integration, along with the adjacent ventral precuneus and the medial, lateral and inferior parietal cortex \cite{dmn_description}.

\subsection{Research topic}
The topic of this article consists of few subproblems: 
\begin{itemize}
\item \textbf{artefact removal} - simultaneous recording of EEG and fMRI is causing a lot of noises in EEG signal. EEG is also very sensitive to heartbeat and eye and body movements. Removing artefacts is important part of feature engineering. 
\item \textbf{retrieving microstates} - different methods can be used to retrieve microstates from EEG \cite{Khanna2015105}. Establishing proper pipeline for retrieving microstates allows them to be robust and valuable features. 
\item \textbf{finding correlation} - once we obtain a features from EEG and values from fMRI, there are various tools that can be used to find correlation. Choosing a right one allows for finding hopefully high correlation with low bias. 
\end{itemize}
\subsection{Current status in literature}
%TODO 
\section{Data}
\label{sec:data}
The EEG and fMRI data were recorded simultaneously. 

The data contains 10 minutes probes from 20 subjects, recorded in free different settings: in atmospheric, increased $CO_2$ and increased $O_2$ conditions. It was recorded in Glostrup Hospital by Egill Rostrup and Ulrich Lindberg as a simultaneous EEG/fMRI. The recording included 30 electrodes for brain activity measurement, one for eye movement and one for heartbeat. The sampling frequency was 500 Hz. The time stamp of launching the fMRI is recorded for each sample, so the data can be trimmed appropriately.
\subsection{Artefact removal}
Initial cleaning of the data, especially removing the fMRI artefacts, has been performed by Glostrup Hospital staff, followed by further artefact removal performed by Andreas Trier Poulsen. This process included notch- and low-pass filtering, as well as using ECG and EOG to get rid of eye blinks and heart beat artefacts. 
The data from only 5 subjects (in all conditions) remained.

\section{Generating microstates}
The input data for this process is artefact-free data from five subjects in all conditions, from 30 electrodes. At the end, we have 30 microstates, from which some will be chosen as regressors in correlation task. 
\subsection{Global Field Power}
Following Yuan et al., we calculated the Global Field Power time course (GFP), which is a standard deviation across electrodes. Then we found topographies corresponding to peaks in the GFP. The parameters of the peak detection algorithm were selected for highest correlation with the fMRI data via a grid search.
\subsection{Independent Component Analysis}
We concatenated the topographies from peaks across subjects, and run ICA. Our algorithm of choice was FastICA \cite{fast_robust} with the cubic non-linearity function. The resulting separation matrix was applied to the continuous EEG to obtain time courses of the microstates.
\subsection{Hemodynamic response function}   
We constructed a binary matrix which encodes which microstate has the highest activation at each time, and convolved it with the hemodynamic response function to adjust for the time-delay of the BOLD fMRI response. These were used as regressors in the elastic net model \cite{hastie01}. 

\section{Correlation of microstates and DMN}
We constructed a binary matrix which encodes which microstate has the highest activation at each time, and convolved it with the hemodynamic response function to adjust for the time-delay of the BOLD fMRI response. These were used as regressors in the elastic net model \cite{hastie01}.
\subsection{Independent Components from fMRI}
\subsection{Elastic net}
As suggested in the literature \cite{Yuan20122062}, each RSN is related with one or a combination of several microstates. Yuan identified 13 microstates related to different RSN. We wished to find which of the microstates (time course) that characterizes the default mode network. Performing both feature selection and variance reduction by shrinking the coefficients in imposing a penalty on the coefficients, the elastic-net (EN) \cite{hastie01} provides a framework for a model describing the relation between the EEG microstates and independent component of the BOLD fMRI DMN.
The elastic-net selects variables like the lasso, and shrinks together the coefficients of correlated predictors like ridge \cite{hastie01}. The elastic net penalty is given in (\ref{eq:Elastic Net}).
\begin{equation}
\label{eq:Elastic Net}
\lambda \sum_{j=1}^p
\begin{pmatrix}
\alpha |\beta_j| + (1-\alpha) \beta_j^2
\end{pmatrix}
\end{equation}
The elastic-net is implemented with the least angle regression (LAR) method. The full path of the LAR with $\lambda=0$ gives the general linear model.


\subsection{Cross-validation}
Estimating the EL-penalty in (\ref{eq:Elastic Net}) we performed 5-fold cross-validation using all the artefact corrected data. However, since this is a limited amount of data we did not set a side a independent test.
We chose to randomly divide the data into the 5 folds to adjust to the fact that the behaviour of a subject might 'change' over time in the scanner e.g. fall asleep. Hence, we limit the correlation in time between the training data and test data. However, since we did not have an independent test set, we could not assess the generalization error. Instead, we estimated the error on the validation set.



\section{Experiments}

In the experiments described we assumed that each subject is independent and further that microstates are common states across subjects (DO WE HAVE A REFERENCE HERE?). This allowed us to concatenated data from different subjects and perform model selection based on a larger data set.
\subsection{Model and peak size}
As suggested in 
The GFP is an sensitive measure and it is not clear whether all local peaks of the GFP should be included as input in estimating the decomposition matrix. These local peaks can be seen as 'raw' microstates. We performed a grid search altering the minimum width and height of the peaks. The width and height was linearly spaced between 0 and 100 ms, and max(GFP)/2 respectively, constraining the transient brain state (peak) to be quasi stable near 100 ms.
We used the maximum correlation of the time course of the microstate with the DMN and used these design settings for the elastic-net.
We performed 5-fold cross-validation with $\lambda$ log-spaced in the interval 
[ $10^{-4}$ ; $10^2$] in estimating the EN model.
\subsection{Robustness of the microstates}
In order to evaluate the robustness of the algorithm of finding microstates, we altered the minimum peak width and height, as described above, in the peak detection and performed 5-fold cross validation omitting one subject at each fold. In each fold, for a specific set of parameters in the peak detection, we found a set of microstates ordered by the power explained. We aligned the matrices to be of the same sign using correlation of the first column of the mixing matrices with respect to the first fold. We compared the sum of the Frobenius norm of the deviation from the mean of the mixing matrices. We found that the robustness decreased in both directions. Hence, no restrictions should be given for the peak detection algorithm for the maximum robustness.
\section{Results}
\section{Discussion}
MAGNUS:Not robust in correlation altering peaks

%discuss comparison with Yuan article
\if false
\section{ILLUSTRATIONS, GRAPHS, AND PHOTOGRAPHS}
\label{sec:illust}

Illustrations must appear within the designated margins.  They may span the two
columns.  If possible, position illustrations at the top of columns, rather
than in the middle or at the bottom.  Caption and number every illustration.
All halftone illustrations must be clear black and white prints.  Colors may be
used, but they should be selected so as to be readable when printed on a
black-only printer.

Since there are many ways, often incompatible, of including images (e.g., with
experimental results) in a LaTeX document, below is an example of how to do
this \cite{Lamp86}.

% Below is an example of how to insert images. Delete the ``\vspace'' line,
% uncomment the preceding line ``\centerline...'' and replace ``imageX.ps''
% with a suitable PostScript file name.
% -------------------------------------------------------------------------
\begin{figure}[htb]

\begin{minipage}[b]{1.0\linewidth}
  \centering
%  \centerline{\includegraphics[width=8.5cm]{image1}}
%  \vspace{2.0cm}
  \centerline{(a) Result 1}\medskip
\end{minipage}
%
\begin{minipage}[b]{.48\linewidth}
  \centering
%  \centerline{\includegraphics[width=4.0cm]{image3}}
%  \vspace{1.5cm}
  \centerline{(b) Results 3}\medskip
\end{minipage}
\hfill
\begin{minipage}[b]{0.48\linewidth}
  \centering
%  \centerline{\includegraphics[width=4.0cm]{image4}}
%  \vspace{1.5cm}
  \centerline{(c) Result 4}\medskip
\end{minipage}
%
\caption{Example of placing a figure with experimental results.}
\label{fig:res}
%
\end{figure}

% To start a new column (but not a new page) and help balance the last-page
% column length use \vfill\pagebreak.
% -------------------------------------------------------------------------
\vfill
\pagebreak
\fi
\section{Conclusions}
\section{Acknowledgements}
\bibliographystyle{IEEEbib}
\bibliography{refs}

\end{document}
